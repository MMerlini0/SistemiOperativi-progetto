
Come funziona mmap:
    #include <sys/mman.h>
    void *mmap(void addr[.length], size_t length, int prot, int flags, int fd, off_t offset);
    ptr = mmap(
        address = NULL,
        length = *******,
        protection = READ | WRITE,
        flags = PRIVATE | ANONYMOUS,
        fd = -1,
        offset = 0
    )
    int munmap(void addr[.length], size_t length);



Fuzione che userei:


function allocate_memory(size):
    alignment = PAGE_SIZE  # tipicamente 4096 bytes
    aligned_size = round_up(size, alignment)

    ptr = mmap(
        address = NULL,
        length = aligned_size,
        protection = READ | WRITE,
        flags = PRIVATE | ANONYMOUS,
        fd = -1,
        offset = 0
    )

    if ptr == MAP_FAILED:
        raise Error("Allocation failed")

    return ptr

(free = munmap(ptr, size);)



